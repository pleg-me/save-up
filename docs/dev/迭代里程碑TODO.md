# 未来银行家（单机版）迭代里程碑 TODO

基于 `Phaser + Vite + TypeScript` 技术栈与《docs/游戏设计-单机版.md》设计文档，将 33 项任务按里程碑拆分为可执行清单。

— 目标：交付一个可通关的 MVP，并保留后续扩展空间。

## 里程碑 M1：基础场景与状态（项目可运行）
- [x] 初始化 Phaser+Vite+TS 项目依赖与配置（dev 正常）
- [x] 创建 BootScene 与资源加载机制（加载占位资源，跳转主菜单）
- [x] 创建 主菜单场景 与“开始新游戏”入口（开始/读档/设置）
- [x] 实现 随机抽取身份与目标 的开局流程（仅开局抽取）
- [x] 设计 GameState 接口与全局状态管理（核心字段与事件总线）

## 里程碑 M2：月份循环与行动（基础玩法可体验）
- [x] 搭建 月度循环状态机（月初/行动/AP/月末）
  - 已实现：`startMonth()` 发放收入并重置 AP；`consumeAP()` 行动点消耗；`endMonth()` 递增月份并开启新月。
- [x] 实现 月初发放收入 与必要支出生成（按身份与规则）
  - 已实现：月初发放身份收入（含学习加成）；每月随机生成 1 项必要支出（示例）。
- [x] 实现 当月行动点(AP)消耗与校验逻辑（用尽需结束本月）
  - 已实现：AP 不足时禁用行动按钮；依据需求可在 AP>0 时结束本月。
- [x] 实现 储蓄动作 与金额输入面板（钱包→储蓄）
  - 已实现：右侧“金额选择器”替代 prompt，储蓄扣款入“储蓄”。
- [x] 实现 投资动作（钱包→投资：单一池）
  - 已实现：投入金额；月末收益为随机 -10% ~ +10%。
- [x] 实现 兼职动作 与收益及副作用（收益与心情影响）
  - 已实现：消耗 2AP，获得 60–180 收益，心情 -10。
- [x] 实现 学习动作 与下月收入提升逻辑（可叠加至上限）
  - 已实现：消耗 2AP，每次 +50 收入加成；累计加成封顶 200。
- [x] 实现 消费动作 与心情值变动（可选系统）
  - 已实现：消费扣款，心情 +10；HUD 显示心情并随行动刷新。
- [ ] 实现 应急基金 管理与自动抵消费用（达到阈值后抵消一次意外）
  - 进度：已实现应急基金存入与显示；自动抵消“意外事件”将随 M3 事件系统一并落地。

## 里程碑 M3：事件与结算（数值闭环成型）
- [x] 建立 事件引擎（必要/意外/机会）与概率模型（数据驱动）
- [x] 实现 事件队列 与处理交互UI（列表+详情+处理）
- [x] 实现 月末结算：储蓄利息与投资收益（按档位概率）
- [x] 实现 月末结算：必要支出与事件后果（滞纳/罚金/心情影响）
- [x] 可在意外事件旁显示“自动抵消来源”（应急/钱包/心情），便于玩家理解结算结果。
- 事件详情面板
  - [ ] 在右侧列表点击某事件弹出详情卡片：描述、影响、处理方式（必要支出/意外）。
  - [ ] 支持“查看历史结算日志”，便于玩家理解每月变化。
- 结算日志与HUD“信息流”
  - [ ] 在结束本月后，在右侧/底部显示本月结算摘要：储蓄利息、投资收益、必要滞纳金、意外抵消来源与金额。
  - [ ] 保留最近 N 条日志（例如 5 条），提供清理按钮。
- 意外事件丰富与概率调整
  - [ ] 增加不同等级与标签（医疗/家电/交通），按身份与月份调整触发概率与金额区间。
  - [ ] 支持少量“机会事件”（正收益），提高可玩性。

## 里程碑 M4：HUD 与日志（核心信息可视）
- [x] 搭建 HUD：顶部信息与“结束本月”按钮（月份/身份/目标）
- [x] 搭建 HUD：左侧账户余额与AP显示（钱包/储蓄/投资/应急/AP）
- [x] 搭建 HUD：右侧行动面板与事件列表（行动入口与队列）
- [x] 搭建 底部日志面板 与消息系统（结算与提示）

## 里程碑 M5：胜利与复盘（闭环通关）
- [x] 实现 胜利条件判断 与通关流程（储蓄+投资≥目标金额）
- [x] 创建 复盘报告场景 与统计指标汇总（月数/储蓄率/投资胜率/意外与应急等）

## 里程碑 M6：持久化与难度（可长期游玩）
- [ ] 实现 本地存档与读档（自动+手动，JSON 持久化）
- [ ] 实现 难度设置（普通/挑战/自定义：利率/AP/事件频率）
- [ ] 添加 数据驱动配置文件（身份/目标/事件/数值，位于 `web/src/data/`）

## 里程碑 M7：打磨与验证（体验与稳定性）
- [ ] 引入 简易折线图展示账户变化（复利与趋势可视化）
- [ ] 编写 数值校验与边界用例的单元测试（利息/概率/AP/胜利判定）
- [ ] 完成 MVP 数值平衡 与事件概率初版（调参与验证）
- [ ] 优化 UI布局与交互反馈（动画/提示与错误处理）

## 里程碑 M8：交付与构建（可发布）
- [ ] 撰写 开发文档与用户教程（README/指南）
- [ ] 打包与部署流程校验（dev/build 命令与产物）

——
备注：本清单覆盖 33 项任务；若新增需求（如 NPC/长期目标/动态经济），请追加至相应里程碑或建立 M9+。


